<style>
    body {
        background-image: url('/static/images/main-bg.jpg');
        background-size: cover;
        background-attachment: fixed;
        background-repeat: no-repeat;

        margin: 0;
        padding: 0;
    }

    .custom-a {
        text-decoration: none;
        color: rgb(32, 32, 32);
    }

    .custom-a:hover {
        text-decoration: none;
        color: rgb(97, 97, 97);
    }
</style>

<html>
    <head>
        <title>Account | leotecno.tk</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <nav class="navbar navbar-expand-lg navbar-dark navbar-shadow shadow-lg fixed-top">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/updates">Bacheca</a>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" onclick="getRandomSite()">Sito casuale</button>
                    </li>
                    <!--li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img src="/static/images/accounts/letters/L.png" alt="Profilo Utente" class="rounded-circle" style="width: 40px; height: 40px;">
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Something else here</a>
                        </div>
                    </li!-->
                </ul>
                {% if current_user.is_authenticated %}
                    <a href="/account/settings" class="ms-auto" style="margin-right: 10px;">
                        <img class="rounded-circle shadow-4-strong" height="40" width="40" alt="usericon" src="{{current_user.logo}}" />
                    </a>
                {% else %}
                    <a class="btn btn-primary ms-auto" href="/account/login" style="margin-right: 10px;">Accedi</a>
                {% endif %}
            </div>
        </nav>
    </head>
    <body>
        <div class="d-flex">
            <div class="row">
                <div class="col">
                    <div class="card" style="background: rgba(255, 255, 255, 0.411); border: none; margin-top: 70px; margin-left: 10px; width: 300px; height: 850px;">
                        <div class="card-body">
                            <a href="/account/info" class="custom-a" id="accountLink">Su di me</a>
                            <hr style="color: white;">
                            <a href="/account/security" class="custom-a" id="securityLink">Privacy e Sicurezza</a>
                            <hr style="color: white;">
                            <a href="/account/connected-sites" class="custom-a" id="friendsLink">Siti collegati</a>
                            <hr style="color: white;">
                            <a href="/account/danger-zone" class="custom-a" id="friendsLink">Danger zone</a>
                            <hr style="color: white;">
                            <a href="/account/logout" class="custom-a">Logout</a>
                            <hr style="color: white;">
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card" style="background: rgba(255, 255, 255, 0.411); border: none; margin-top: 70px; width: 1569px; height: 850px;">
                        <div class="card-body text-center">
                            <br>
                            <button style="background: none; border: none;" data-toggle="modal" data-target="#changeLogoModal"><img class="rounded-circle shadow-4-strong" height="100" width="100" style="object-fit: cover;" alt="usericon" src="{{current_user.logo}}" /></button>
                            <br>
                            <br>
                            <h3>Ciao, {{current_user.username}}.</h3>
                            <hr class="mx-auto" style="width: 600px;">
                            <br>
                            <h5>...cerchi qualcosa?</h5>
                            <br>
                            <div class="row justify-content-center">
                                <div class="col-3 mb-3" style="margin-left: 70px;">
                                    <div class="card" style="width: 18rem; background: rgba(255, 255, 255, 0.411); border: none;">
                                        <div class="card-body">
                                            <ion-icon name="person-outline" style="font-size: 50px; color: rgb(23, 96, 255);"></ion-icon>
                                            <br>
                                            <h5>Info su di me</h5>                                                                                          
                                            <p>Modifica e controlla i tuoi dati personali</p>
                                        </div>
                                        <ul class="list-group list-group-flush" style="background: rgba(255, 255, 255, 0.411);">
                                            <a class="list-group-item" style="font-size: 15px; background-color: blue; color: white;" href="/account/info">Info su di me ></a>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-3 mb-3">
                                    <div class="card" style="width: 18rem; background: rgba(255, 255, 255, 0.411); border: none;">
                                        <div class="card-body">
                                            <ion-icon name="lock-closed-outline" style="font-size: 50px; border: none; color: rgb(23, 96, 255);"></ion-icon>
                                            <br>
                                            <h5>Sicurezza dell'account</h5>
                                            <p>Gestisci la sicurezza del tuo account: modifica la password e aggiungi metodi di sicurezza per accedere</p>
                                        </div>
                                        <ul class="list-group list-group-flush">
                                            <a class="list-group-item" style="font-size: 15px; background-color: green; color: white;" href="/account/security">Privacy e Sicurezza ></a>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-3 mb-3">
                                    <div class="card" style="width: 18rem; background: rgba(255, 255, 255, 0.411); border: none;">
                                        <div class="card-body">
                                            <ion-icon name="attach-outline" style="font-size: 50px; border: none; color: rgb(23, 96, 255);"></ion-icon>
                                            <br>
                                            <h5>Siti collegati</h5>
                                            <p>Controlla e gestisci i siti a cui hai effettuato l'accesso con l'account leotecno.tk</p>
                                        </div>
                                        <ul class="list-group list-group-flush">
                                            <a class="list-group-item" style="font-size: 15px; background-color: rgb(153, 5, 5); color: white;" href="/account/atteched-sites">Siti collegati ></a>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--MODALS-->
                <div class="modal fade" id="changeLogoModal" tabindex="-1" role="dialog" aria-labelledby="changeLogoModal" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Cambia immagine profilo</h5>
                        <span type="button" class="close" data-dismiss="modal" aria-label="Close">
                            &times;
                        </span>
                        </div>
                        <div class="modal-body">
                            <form id="changeLogo" enctype="multipart/form-data">
                                <label class="form-label" for="customFile">Carica un'immagine</label>
                                <input type="file" class="form-control" id="logo" name="logo" />
                                <br>
                                <div class="d-flex justify-content-end">
                                    <button type="button" id="submitChangeLogo" class="btn btn-primary">Applica</button>
                                </div>                             
                            </form>
                        </div>
                    </div>
                    </div>
                </div>

            </div>
        </div>
    </body>

    <!--SCRIPTS-->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <!--script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script!-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <!--script src="https://code.jquery.com/jquery-3.6.0.min.js"></script!-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
    <script src="/static/scripts/JS/random_site.js"></script>
    <script>
        // CHANGE LOGO
        $('#submitChangeLogo').click(function () {
            var formData = new FormData();

            var fileInput = $('#logo')[0].files[0];
            formData.append('logo', fileInput);

            $.ajax({
                url: '/account/actions/changeLogo',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                dataType: 'json',
                success: function(data) {
                    // Gestisci il risultato ottenuto
                    if (data.result === "error") {
                        // $(document).ready(function() {
                        //    $('#errorModal').modal('show');
                        //    $('#popupText').text(data.popup_text);
                        // });
                    
                        // $(document).ready(function() {
                        //    var errorText = document.getElementById("error");
                        //    error.style.display = "block";
                        //    $('#error').text(data.popup_text);
                        // });

                        alert(data.popup_text);
                    } else {
                        location.reload();
                    }
                },
                error: function(error) {
                    console.log("Errore nella richiesta AJAX:", error);
                }
            });
        });
    </script>
</html>